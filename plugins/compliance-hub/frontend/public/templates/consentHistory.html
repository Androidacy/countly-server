<cly-main>
    <div class="bu-level bu-my-3">
        <div class="bu-level-left bu-my-3">
            Consent History for
            <cly-select-x class="bu-ml-3 bu-mr-3" :width="300" :borderless="true" :adaptiveLength="true"
                :auto-commit="true" :hide-default-tabs="true" :arrow="false" :hide-all-options-tab="true" :options="filter1"
                v-model="selectedfilterforConsent">
            </cly-select-x>
            <span> and </span>
            <cly-select-x class="bu-ml-3 bu-mr-3" :width="300" :borderless="true" :auto-commit="true"
                :adaptiveLength="true" :arrow="false" :hide-default-tabs="true" :hide-all-options-tab="true" :options="filter0"
                v-model="selectedfilterforMetrics">
            </cly-select-x>
        </div>
        <cly-date-picker-g type="daterange" range-separator="To" start-placeholder="Start date"
            end-placeholder="End date">
        </cly-date-picker-g>
    </div>
    <cly-section>
        <cly-datatable-n :data-source="consentHistoryTableSource" :default-sort="{prop: 'ts', order: 'descending'}">
            <template v-slot="scope">
                <el-table-column type="expand">
                    <template slot-scope="props">
                        <div class="bu-level cly-vue-compliance__consent_history_expanded_column">
                            <div class="bu-level-left">Device ID</div>
                            <div style="width: 80%;" class="bu-level-right">
                                <p style="width: 100%;">{{props.row.device_id}}</p>
                            </div>
                        </div>
                        <div v-if="props.row.optin.length > 0"
                            class="bu-level cly-vue-compliance__consent_history_expanded_column">
                            <div class="bu-level-left">Opt in</div>
                            <div style="width: 80%;" class="bu-level-right">
                                <p style="width: 100%;">
                                    {{props.row.optin.join(',')}}
                                </p>
                            </div>
                        </div>
                        <div v-if="props.row.optout.length > 0"
                            class="bu-level cly-vue-compliance__consent_history_expanded_column">
                            <div class="bu-level-left">Opt out</div>
                            <div style="width: 80%;" class="bu-level-right">
                                <p style="width: 100%;">
                                    {{props.row.optout.join(',')}}
                                </p>
                            </div>
                        </div>
                        <div class="bu-level cly-vue-compliance__consent_history_expanded_column">
                            <div class="bu-level-left">Device</div>
                            <div style="width: 80%;" class="bu-level-right">
                                <p style="width: 100%;">
                                    {{props.row.d + "(" + props.row.p + " " + props.row.pv + ")"}}
                                </p>
                            </div>
                        </div>
                        <div class="bu-level cly-vue-compliance__consent_history_expanded_column">
                            <div class="bu-level-left">App version</div>
                            <div style="width: 80%;" class="bu-level-right">
                                <p style="width: 100%;">
                                    {{props.row.av}}
                                </p>
                            </div>
                        </div>
                        <!-- <p>City: {{ props.row.city }}</p>
                                              <p>Address: {{ props.row.address }}</p>
                                              <p>Zip: {{ props.row.zip }}</p> -->
                    </template>
                </el-table-column>
                <el-table-column sortable="custom" prop="_id" label="ID">
                </el-table-column>
                <el-table-column sortable="custom" prop="uid" label="UID">
                </el-table-column>
                <el-table-column sortable="custom" label="CHANGES">
                    <template v-slot="rowScope">
                        <div>
                            <p v-if="rowScope.row.type.includes('i')">Opt in</p>
                            <p v-if="rowScope.row.type.includes('o')">Opt out</p>
                        </div>

                    </template>

                </el-table-column>
                <el-table-column sortable="custom" label="CONSENT">
                    <template v-slot="rowScope">
                        <div>
                            <p v-if="rowScope.row.optin.length > 0">Opt in for {{rowScope.row.optin.length}} feature(s)
                            </p>
                            <p v-if="rowScope.row.optout.length > 0">Opt out from {{rowScope.row.optout.length}}
                                feature(s)</p>
                        </div>

                    </template>

                </el-table-column>
                <el-table-column sortable="custom" prop="av" label="APP VERSION">
                </el-table-column>
                <el-table-column sortable="custom" prop="ts" label="TIME">
                    <template v-slot="rowScope">
                        {{rowScope.row.time}}

                    </template>
                </el-table-column>
                <!-- <el-table-column sortable="custom" prop="p" :label="tableHeader[3]">
                </el-table-column>
                <el-table-column sortable="custom" prop="curr_paying_non_paying" :label="tableHeader[4]">
                </el-table-column> -->
            </template>
        </cly-datatable-n>

    </cly-section>
</cly-main>