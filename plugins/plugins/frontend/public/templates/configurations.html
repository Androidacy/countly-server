<div v-bind:class="[componentId]">
    <cly-header>
        <template v-if="back" v-slot:header-top>
            <cly-back-link v-on:click="goBack" :title="i18n('plugins.back')"></cly-back-link>
        </template>
        <template v-slot:header-left>
            <h2> {{i18n('plugins.configs')}} </h2>
        </template>
    </cly-header>
    <cly-main class="bu-pt-4">
        <div class="bu-columns bu-is-gapless">
            <div class="bu-column bu-is-3 bu-mr-5" style="max-height:681px">
                <cly-listbox
                    skin="jumbo"
                    height="624"
                    :searchPlaceholder="searchPlaceholder"
                    :options="configsList"
                    :searchable="true"
                    v-model="selectedConfigSearchBar">
                    </cly-listbox>
            </div>
            <div class="bu-column bu-is-9" v-if="predefinedStructure[selectedConfig]">
                <h2 class="bu-mb-4"> {{selectedConfigName}} </h2>
                <div v-if="predefinedStructure[selectedConfig].description" class="bu-mb-4">{{i18n(predefinedStructure[selectedConfig].description)}}</div>
                <div :key="group.label" v-for="group in predefinedStructure[selectedConfig].groups">
                    <h3 v-if="predefinedStructure[selectedConfig].groups.length > 1 || group.label" class="bu-my-4"> {{group.label && i18n(group.label)}} &nbsp;</h3>
                    <cly-section class="bu-mr-4">
                        <template slot-scope="scope">
                            <div 
                                v-if="key !== '_user' && configsData[selectedConfig] && typeof configsData[selectedConfig][key] !== 'undefined'" 
                                v-for="key in group.list" :key="key" 
                                class="bu-columns bu-is-vcentered bu-p-3 bu-mx-1 config-section">
                                <div class="bu-column bu-is-7">
                                    <p class="bu-has-text-weight-medium">{{getLabelName(key)}}</p>
                                    <p v-html="getHelperLabel(key)"></p>
                                </div>
                                <div class="bu-column bu-is-1"></div>
                                <div class="bu-column bu-is-3 bu-has-text-left">
                                    <div 
                                        v-if="getInputType(key) === 'function'" 
                                        v-html="predefinedInputs[selectedConfig + '.' + key](configsData[selectedConfig][key])">
                                    </div>
                                    <el-input
                                        v-else-if="getInputType(key) === 'el-input'" 
                                        @input="onChange(key, $event)"
                                        :value="configsData[selectedConfig][key]"
                                        v-bind="predefinedInputs[selectedConfig + '.' + key].attrs"
                                        >
                                    </el-input>
                                    <el-select 
                                        v-else-if="getInputType(key) === 'el-select'" 
                                        @change="onChange(key, $event)"
                                        :value="configsData[selectedConfig][key]"
                                        v-bind="predefinedInputs[selectedConfig + '.' + key].attrs">
                                        <el-option :key="option.value" :value="option.value" :label="option.label" v-for="option in predefinedInputs[selectedConfig + '.' + key].list"></el-option>
                                    </el-select>
                                    <el-slider 
                                        v-else-if="getInputType(key) === 'el-slider'" 
                                        @change="onChange(key, $event)"
                                        :value="configsData[selectedConfig][key]"
                                        v-bind="predefinedInputs[selectedConfig + '.' + key].attrs">
                                    </el-slider>
                                    <el-button
                                        v-else-if="getInputType(key) === 'el-button'" 
                                        @click="predefinedInputs[selectedConfig + '.' + key].click()"
                                        v-bind="predefinedInputs[selectedConfig + '.' + key].attrs">
                                        {{predefinedInputs[selectedConfig + '.' + key].label}}
                                    </el-button>
                                    <el-switch 
                                        v-else-if="getInputType(key) === 'el-switch'"
                                        @change="onChange(key, $event)"
                                        :value="configsData[selectedConfig][key]"
                                        v-bind="predefinedInputs[selectedConfig + '.' + key].attrs">
                                    </el-switch>
                                    <el-input-number 
                                        v-else-if="getInputType(key) === 'el-input-number'" 
                                        @change="onChange(key, $event)"
                                        :max='2147483647' 
                                        :min='0' 
                                        :value="configsData[selectedConfig][key]"
                                        v-bind="predefinedInputs[selectedConfig + '.' + key].attrs">
                                    </el-input-number>
                                    <el-input 
                                        v-else
                                        @input="onChange(key, $event)"
                                        :value="configsData[selectedConfig][key]">
                                    </el-input>
                                </div>
                            </div>
                        </template>
                    </cly-section>
                </div>
            </div>
        </div>
        <cly-diff-helper :diff="diff" @discard="unpatch" @save="save"></cly-diff-helper>
    </cly-main>
</div>