<div id="push-notification-app-level-config">
    <div class="bu-is-flex bu-is-justify-content-space-between">
        <h3>iOS Settings </h3>
        <el-button type="danger" @click="onDeleteKey(PlatformEnum.IOS)">Delete</el-button>
    </div>
    <cly-inline-form-field label="Authentication type">
        <el-select  :value="iosAuthConfigType" @change="onIOSAuthTypeChange">
            <el-option :key="iosAuthType.value" :value="iosAuthType.value" :label="iosAuthType.label" v-for="iosAuthType in iosAuthConfigTypeOptions"></el-option>
        </el-select>
    </cly-inline-form-field>
        <cly-inline-form-field :label="iosAuthConfigType === IOSAuthConfigTypeEnum.P8 ? 'Key file (P8)' : 'Sandbox + Production certificate (P12)'">
            <div class="bu-is-flex bu-is-flex-direction-column">
                <div class="bu-is-flex">
                        <el-upload 
                            ref="keyFileUploader"
                            action=""
                            :on-change="onKeyFileChange"
                            :auto-upload="false"
                            :show-file-list="false"
                            accept="p8, p12">
                                <el-button size="small" type="text" class="bu-p-0">Choose File</el-button>
                        </el-upload>
                    <div class="bu-ml-5">{{uploadedIOSKeyFilename}}</div>
                </div>
                <div v-if="viewModel[PlatformEnum.IOS].hasKeyFile"> Key file ({{viewModel[PlatformEnum.IOS].authType}}) is already uploaded </div>
            </div>
        </cly-inline-form-field>
    <template v-if="iosAuthConfigType === IOSAuthConfigTypeEnum.P8"> 
        <cly-inline-form-field label="Key ID" :rules="{required:isIOSConfigRequired}">
            <el-input :value="viewModel[PlatformEnum.IOS].keyId" @input="onInput('keyId', $event, PlatformEnum.IOS)"></el-input>
        </cly-inline-form-field>
        <cly-inline-form-field label="Team ID" :rules="{required:isIOSConfigRequired}">
            <el-input :value="viewModel[PlatformEnum.IOS].teamId" @input="onInput('teamId', $event, PlatformEnum.IOS)"></el-input>
        </cly-inline-form-field>
        <cly-inline-form-field label="Bundle ID" :rules="{required:isIOSConfigRequired}">
            <el-input :value="viewModel[PlatformEnum.IOS].bundleId" @input="onInput('bundleId',$event,PlatformEnum.IOS)"></el-input>
        </cly-inline-form-field>
    </template>
    <template v-if="iosAuthConfigType === IOSAuthConfigTypeEnum.P12">
        <cly-inline-form-field label="Passphrase" :rules="{required:isIOSConfigRequired}">
            <form>
                <el-input type="password" :value="viewModel[PlatformEnum.IOS].passphrase" @input="onInput('passphrase',$event,PlatformEnum.IOS)"></el-input>
            </form>
        </cly-inline-form-field>
    </template>

    <div class="bu-is-flex bu-is-justify-content-space-between">
        <h3>Android (Google FM) </h3>
        <el-button type="danger" @click="onDeleteKey(PlatformEnum.ANDROID)">Delete</el-button>
    </div>
    <cly-inline-form-field label="Firebase key">
        <el-input :value="viewModel[PlatformEnum.ANDROID].firebaseKey" @input="onInput('firebaseKey',$event,PlatformEnum.ANDROID)"></el-input>
    </cly-inline-form-field>

    <div class="bu-is-flex bu-is-justify-content-space-between">
        <h3>Android (Huawei Push Kit) </h3>
        <el-button type="danger" @click="onDeleteKey(PlatformEnum.HUAWEI)">Delete</el-button>
    </div>
    <cly-inline-form-field label="Huawei App ID" :rules="{required:isHuaweiConfigRequired}">
        <el-input :value="viewModel[PlatformEnum.HUAWEI].appId" @input="onInput('appId',$event,PlatformEnum.HUAWEI)"></el-input>
    </cly-inline-form-field>
    <cly-inline-form-field label="App Secret" :rules="{required:isHuaweiConfigRequired, numeric: true}">
        <el-input :value="viewModel[PlatformEnum.HUAWEI].appSecret" @input="onInput('appSecret',$event,PlatformEnum.HUAWEI)"></el-input>
    </cly-inline-form-field>

    <div> Rate limit </div>
    <cly-inline-form-field label="Maximum number of notifications scheduled per period" rules="numeric">
        <el-input :value="viewModel.rate" @input="onInput('rate',$event)"></el-input>
    </cly-inline-form-field>
    <cly-inline-form-field label="Period duration (seconds)" rules="numeric">
        <el-input :value="viewModel.period" @input="onInput('period',$event)"></el-input>
    </cly-inline-form-field>
    <cly-confirm-dialog 
        title="Delete key"
        dialogType="danger"
        saveButtonLabel="I understand, delete this key" 
        cancelButtonLabel="Cancel" 
        :visible.sync="isDeleteKeyDialogVisible"
        @cancel="onDeleteKeyCancel" 
        @confirm="onDeleteKeyConfirm">
    </cly-confirm-dialog>
</cly-confirm-dialog >
</div>
