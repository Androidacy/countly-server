<div v-bind:class="[componentId, 'cly-vue-dashboards']">
    <cly-main v-if="noDashboards" class="bu-mt-6">
        <no-dashboard></no-dashboard>
    </cly-main>
    <template v-else>
        <header>
            <div style="padding: 32px;">
                <div class="bu-level">
                    <div class="bu-level-left bu-is-flex-shrink-1" style="min-width: 0;">
                        <div class="bu-level-item bu-is-flex-shrink-1" style="min-width: 0;">
                            <h2 class="has-ellipsis">{{dashboard.name}}</h2>
                        </div>
                    </div>
                    <div class="bu-level-right">
                        <div class="bu-level-item">
                            <cly-date-picker-g class="bu-mr-3"></cly-date-picker-g>
                        </div>
                        <div class="bu-level-item">
                            <el-button v-if="canUpdate" @click="newWidget" type="success" icon="el-icon-circle-plus">{{i18n('dashboards.add-widget')}}</el-button>
                        </div>
                        <div class="bu-level-item" v-if="canUpdate">
                            <cly-more-options @command="onDashboardAction($event, dashboard)">
                                <el-dropdown-item command="edit">{{i18n('common.edit')}}</el-dropdown-item>
                                <el-dropdown-item command="duplicate">{{i18n('dashboards.duplicate-dashboard')}}</el-dropdown-item>
                                <el-dropdown-item command="delete">{{i18n('common.delete')}}</el-dropdown-item>
                                <el-dropdown-item><a :href="'#/manage/reports/create/dashboard/' + dashboard._id">{{i18n('dashboards.create-email-reports')}}</a></el-dropdown-item>
                            </cly-more-options>
                        </div>
                    </div>
                </div>
                <div class="bu-level bu-mt-2" v-if="dashboard.creation.time || dashboard.creation.by">
                    <div class="bu-level-left">
                        <div class="bu-level-item">
                            <div class="bu-level-item color-cool-gray-50 text-medium">
                                <span>
                                    <i class="far fa-clock"></i>
                                    {{i18nM('dashbaords.created')}}
                                </span>
                                <span v-if="dashboard.creation.time" class="bu-ml-1">
                                    {{dashboard.creation.time}}
                                </span>
                                <span v-if="dashboard.creation.by" class="bu-ml-1">
                                    {{i18n('dashbaords.created-by', dashboard.creation.by)}}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <cly-main>
            <no-widget v-if="noWidgets" @new-widget="newWidget"></no-widget>
            <dashboards-grid ref="grid" @widget-added="onWidgetAdded"></dashboards-grid>

            <dashboards-drawer :controls="drawers.dashboards"></dashboards-drawer>
            <widgets-drawer @add-widget="addWidgetToGrid" @reset="onReset" :controls="drawers.widgets"></widgets-drawer>
        </cly-main>
    </template>
</div>
